# 三次握手，四次挥手
```
```
## 三次握手
```
    首先客户端发送请求报文，server接受连接后进行回复报文，并为这次通信分配资源，客户端收到之后，也会向服务器发送报文，并分配资源，这样一条TCP就连接了。

    客户端--》服务端--》客户端--》服务端     

    客户端发送一个请求，服务器端应答请求，并为本次提供资源，客户端收到这个响应，并为这次连接分配资源，并发数报文。

```
## 四次挥手
```

    发送断开的可以是客户端，也可以是服务端。
    假如客户端首先发送中断报文，服务器收到断开报文，然后服务器对客户端进行响应，这个时候客户端进入到等待状态。
    如果服务器端无报文发送，那么就会发送一个报文，客户端收到报文之后，就可以关闭连接了。
    然后给服务端响应一个报文，如果服务器没有收到，那么就会重传，等到两秒服务器端无回复，那么就知道服务器端已经关闭了，然后客户端也关闭了。

    【问题1】为什么连接的时候是三次握手，关闭的时候却是四次握手？
    答：因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，"你发的FIN报文我收到了"。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。

    【问题2】为什么TIME_WAIT状态需要经过2MSL(最大报文段生存时间)才能返回到CLOSE状态？
    答：虽然按道理，四个报文都发送完毕，我们可以直接进入CLOSE状态了，但是我们必须假象网络是不可靠的，有可以最后一个ACK丢失。所以TIME_WAIT状态就是用来重发可能丢失的ACK报文。


======================================================================================================
```
# http协议
```
    超文本解析协议 ，是万维网服务器传输超文本到本地的传输协议，基于TCP/IP，面向连接。
    通过URL来定位网络资源，并获取网络上的内容。

```
## 特点
```

    简单快速：每次使用只需要传输方法和路径，程序的规模小，速度快。
    灵活：可以传递任意类型的数据
    无连接：每次请求只会处理一个请求，服务器处理完请求就会断开连接
    无状态：不会记忆上次的操作【session和cookie、token、jwt就是他的解决方案】
    在c/s和b/s中都可以使用

```
## URL
```
    定位网络上唯一的一个URL资源，他是传输数据和建立连接的
    它由协议部分、域名、端口、文件路径、#、？参数

```
## URL和URI的区别
```
    URI唯一定位一个资源，网络上的一个文件都是通过URI定位的
        访问资源的命名机制
        存放资源的主机
        资源自身的名称，由路径表示
    URL：描述信息资源的各种信息资源，包括文件、服务器的地址和目录
    ················································    
    URI 是统一资源标识符，而 URL 是统一资源定位符。因此，笼统地说，每个 URL 都是 URI，但不一定每个 URI 都是 URL。这是因为 URI 还包括一个子类，即统一资源名称 (URN)，它命名资源但不指定如何定位资源。上面的 mailto、news 和 isbn URI 都是 URN 的示例。

    算了太晕了，完全不知道说的是啥
    ················································

```
## Http和request
```

    一个Http请求包括：请求行、请求头、空行、请求数据


```
# Http:的状态码
```

    1XX：指示消息--请求已接收，继续处理
    2XX:表示成功--请求已被成功接收、理解、接受
    3XX:重定向--
    4XX:客户端错误
    5XX:服务端错误

```
## HTTP的工作原理
```

    HTTP协议定义了web客户端如何从web服务器请求web页面，以及服务器如何将数据传递给页面，Http协议采用请求响应，客户端发送一个报文【方法、URL、数据、协议版本、请求头部】
    服务器响应协议版本、成功或者失败、服务器信息、响应头和响应数据。


```
## 请求过程
```
    客户端连接到web服务器
    URL通过DNS解析，得到IP，然后通过80端口，与ip指向的目标服务器进行监理TCP套接字连接。
    发生HTTP请求报文，请求行、请求头、空行和请求数据4个部分
    服务器接收请求并返回响应，解析请求、定位资源，响应一个状态行、响应头部、空行和响应数据4部分
    释放TCP连接
        如果connection是close，那么服务器就主动关闭TCP连接，客户端被动关闭，释放TCP
        若connection模式是keepLive，那么连接就会保持一段时间，在该时间内可以继续接受请求。

5、客户端浏览器解析HTML内容
客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集。客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示。

例如：在浏览器地址栏键入URL，按下回车之后会经历以下流程：

1、浏览器向 DNS 服务器请求解析该 URL 中的域名所对应的 IP 地址;

2、解析出 IP 地址后，根据该 IP 地址和默认端口 80，和服务器建立TCP连接;

3、浏览器发出读取文件(URL 中域名后面部分对应的文件)的HTTP 请求，该请求报文作为 TCP 三次握手的第三个报文的数据发送给服务器;

4、服务器对浏览器请求作出响应，并把对应的 html 文本发送给浏览器;

5、释放 TCP连接;

6、浏览器将该 html 文本并显示内容; 　　

GET和POST请求的区别
GET请求
GET /books/?sex=man&name=Professional HTTP/1.1
Host: www.wrox.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
Gecko/20050225 Firefox/1.0.1
Connection: Keep-Alive
注意最后一行是空行

POST请求
POST / HTTP/1.1
Host: www.wrox.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
Gecko/20050225 Firefox/1.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 40
Connection: Keep-Alive

name=Professional%20Ajax&publisher=Wiley
1、GET提交，请求的数据会附在URL之后（就是把数据放置在HTTP协议头中），以?分割URL和传输数据，多个参数用&连接；例 如：login.action?name=hyddd&password=idontknow&verify=%E4%BD%A0 %E5%A5%BD。如果数据是英文字母/数字，原样发送，如果是空格，转换为+，如果是中文/其他字符，则直接把字符串用BASE64加密，得出如： %E4%BD%A0%E5%A5%BD，其中％XX中的XX为该符号以16进制表示的ASCII。

POST提交：把提交的数据放置在是HTTP包的包体中。上文示例中红色字体标明的就是实际的传输数据

因此，GET提交的数据会在地址栏中显示出来，而POST提交，地址栏不会改变
2、传输数据的大小：首先声明：HTTP协议没有对传输的数据大小进行限制，HTTP协议规范也没有对URL长度进行限制。

而在实际开发中存在的限制主要有：

GET:特定浏览器和服务器对URL长度有限制，例如 IE对URL长度的限制是2083字节(2K+35)。对于其他浏览器，如Netscape、FireFox等，理论上没有长度限制，其限制取决于操作系 统的支持。

因此对于GET提交时，传输数据就会受到URL长度的 限制。

POST:由于不是通过URL传值，理论上数据不受 限。但实际各个WEB服务器会规定对post提交数据大小进行限制，Apache、IIS6都有各自的配置。

3、安全性

POST的安全性要比GET的安全性高。比如：通过GET提交数据，用户名和密码将明文出现在URL上，因为(1)登录页面有可能被浏览器缓存；(2)其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了，除此之外，使用GET提交数据还可能会造成Cross-site request forgery攻击

4、Http get,post,soap协议都是在http上运行的

（1）get：请求参数是作为一个key/value对的序列（查询字符串）附加到URL上的
查询字符串的长度受到web浏览器和web服务器的限制（如IE最多支持2048个字符），不适合传输大型数据集同时，它很不安全

（2）post：请求参数是在http标题的一个不同部分（名为entity body）传输的，这一部分用来传输表单信息，因此必须将Content-type设置为:application/x-www-form- urlencoded。post设计用来支持web窗体上的用户字段，其参数也是作为key/value对传输。
但是：它不支持复杂数据类型，因为post没有定义传输数据结构的语义和规则。

（3）soap：是http post的一个专用版本，遵循一种特殊的xml消息格式
Content-type设置为: text/xml 任何数据都可以xml化。

Http协议定义了很多与服务器交互的方法，最基本的有4种，分别是GET,POST,PUT,DELETE. 一个URL地址用于描述一个网络上的资源，而HTTP中的GET, POST, PUT, DELETE就对应着对这个资源的查，改，增，删4个操作。 我们最常见的就是GET和POST了。GET一般用于获取/查询资源信息，而POST一般用于更新资源信息.

我们看看GET和POST的区别

GET提交的数据会放在URL之后，以?分割URL和传输数据，参数之间以&相连，如EditPosts.aspx?name=test1&id=123456. POST方法是把提交的数据放在HTTP包的Body中.

GET提交的数据大小有限制（因为浏览器对URL的长度有限制），而POST方法提交的数据没有限制.

GET方式需要使用Request.QueryString来取得变量的值，而POST方式通过Request.Form来获取变量的值。

GET方式提交数据，会带来安全问题，比如一个登录页面，通过GET方式提交数据时，用户名和密码将出现在URL上，如果页面可以被缓存或者其他人可以访问这台机器，就可以从历史记录获得该用户的账号和密码.

